# CILS - æ™ºèƒ½è·¨å¢ƒç”µå•† ERP æ ¸å¿ƒç³»ç»Ÿ (Intelligent Cross-Border ERP Core)

> åŸºäº Java 21 + Spring Boot 3 + pythonæ„å»ºçš„è·¨å¢ƒç”µå•†ä¸­å°ï¼Œé›†æˆäº† LLM æ™ºèƒ½é£æ§ã€å¤šè¯­è¨€è‡ªåŠ¨ç¿»è¯‘åŠé«˜å¹¶å‘åº“å­˜ç®¡ç†èƒ½åŠ›ã€‚

## ğŸ“– é¡¹ç›®ç®€ä»‹ (Introduction)

CILS (Cross-border Intelligent Listing System) æ˜¯ä¸€ä¸ªé’ˆå¯¹è·¨å¢ƒç”µå•†ï¼ˆAmazon, Shopee ç­‰ï¼‰å¤šå¹³å°é“ºè´§åœºæ™¯è®¾è®¡çš„æ ¸å¿ƒä¸šåŠ¡ä¸­å°ã€‚

é’ˆå¯¹ä¼ ç»Ÿ ERP ç³»ç»Ÿä¸­**äººå·¥å®¡æ ¸æˆæœ¬é«˜ã€å¤šè¯­è¨€ä¸Šæ¶ç¹çã€é«˜å¹¶å‘åº“å­˜è¶…å–**ç­‰è¡Œä¸šç—›ç‚¹ï¼Œæœ¬é¡¹ç›®å¼•å…¥äº†ç”± **Gemini / OpenAI / OpenRouter / DeepSeek** æ„æˆçš„** AI æ™ºèƒ½é™çº§é“¾è·¯**ï¼Œä»¥åŠ **Redis + Kafka é«˜å¹¶å‘æ¶æ„**ï¼Œå®ç°äº†ä»å•†å“å½•å…¥ã€åˆè§„æ ¡éªŒã€è‡ªåŠ¨ç¿»è¯‘åˆ°å¤šå¹³å°æ¨é€çš„å…¨æµç¨‹è‡ªåŠ¨åŒ–é—­ç¯ã€‚

## ğŸ“º æ¼”ç¤ºè§†é¢‘ (Demo Videos)

- **[ä¸»è§†é¢‘] æœ¬é¡¹ç›®å®Œæ•´åŠŸèƒ½è§£è¯´å’Œæ¼”ç¤ºè§†é¢‘**ï¼š[ç‚¹å‡»æŸ¥çœ‹ (æŠ–éŸ³)](https://v.douyin.com/06oNzU6Ru6o/)
- **[è¡¥å……å½•åˆ¶] API é²æ£’æ€§ä¸å¤šçº§é™çº§å®¹é”™æœºåˆ¶æ¼”ç¤º**ï¼š[ç‚¹å‡»æŸ¥çœ‹ (æŠ–éŸ³)](https://v.douyin.com/P0GekMsiITQ/)

## ğŸ›  æŠ€æœ¯æ ˆ (Tech Stack)

- **æ ¸å¿ƒæ¡†æ¶**: Spring Boot 2.5.x (åŸºäº Java 21 è¿è¡Œ)
- **æ•°æ®åº“**: MySQL 8.0 (MyBatis-Plus)
- **ç¼“å­˜ä¸å¹¶å‘**: Redis (åŸå­æŒ‡ä»¤ DECRBY, Cache Aside æ¨¡å¼)
- **æ¶ˆæ¯é˜Ÿåˆ—**: Apache Kafka (æµé‡å‰Šå³°, æœ€ç»ˆä¸€è‡´æ€§)
- **AI é™çº§é“¾**: Python 3.x (Gemini / OpenAI / OpenRouter / DeepSeek)
- **å‰ç«¯**: Vue 3 + Element Plus (é›†æˆåŠ¨æ€æ ¡éªŒä¸å¸ç§ä¸‹æ‹‰)
- **ä»»åŠ¡è°ƒåº¦**: Spring Scheduled + Quartz
- **å·¥å…·**: Lombok, FastJson2, OpenAI SDK 1.x

## ğŸŒŸ æ ¸å¿ƒäº®ç‚¹ (Core Features)

### 1. ğŸ›¡ï¸ åŸºäº LLM çš„å¤šæ¨¡æ€æ™ºèƒ½é™çº§å¼•æ“
æ‘’å¼ƒäº†å•ä¸€æ¨¡å‹ä¾èµ–ï¼Œæ„å»ºäº†ä¸€å¥—**å…¨èƒ½è‡ªæ„ˆ (Self-Healing)** çš„ AI æ ¡éªŒç³»ç»Ÿã€‚
- **é™çº§é“¾è·¯**ï¼š`Gemini (å®˜æ–¹)` ã€ `OpenRouter (å…è´¹é›†ç¾¤)` ã€ `DeepSeek(å®˜æ–¹)` ã€ `OpenAI (ç»ˆæä¿åº•)`ã€‚
- **æ™ºèƒ½è§†è§’è·¯ç”±**ï¼šè‡ªåŠ¨è¯†åˆ«è¯·æ±‚ç±»å‹ï¼Œè‹¥åŒ…å«å›¾ç‰‡åˆ™ç²¾å‡†è·¯ç”±è‡³æ”¯æŒè§†è§‰çš„æ¨¡å‹ä¸“çº¿ï¼ˆå¦‚ Gemini/GPT-4oï¼‰ï¼Œå¹¶é’ˆå¯¹ OpenAI 2025 æ–°ç‰ˆAPI (Responses API) è¿›è¡Œäº†æ·±åº¦æ ¼å¼é€‚é…ã€‚
- **DeepSeek æ·±åº¦è‡ªæ„ˆ**ï¼šä¸º DeepSeek èŠ‚ç‚¹å¢åŠ äº† **â€œ3æ¬¡é‡è¯•/5ç§’é—´éš”â€** é€»è¾‘ï¼Œæå¤§åœ°æå‡äº†ç³»ç»Ÿåœ¨æç«¯ API é™æµç¯å¢ƒä¸‹çš„ç”Ÿå­˜èƒ½åŠ›ã€‚
- **åŠ¨æ€è§„åˆ™é…ç½®**ï¼šæ”¯æŒåœ¨æ•°æ®åº“ä¸­åŠ¨æ€é…ç½®æ ¡éªŒ Promptï¼Œæ— éœ€é‡å¯æœåŠ¡å³å¯ç”Ÿæ•ˆã€‚
- **å…¨é“¾è·¯å¼‚æ­¥è‡ªæ„ˆæ ¡éªŒ**ï¼šé‡‡ç”¨é«˜æ€§èƒ½å¼‚æ­¥è°ƒåº¦æ¨¡å¼ï¼Œå®ç°ä»å•†å“å½•å…¥åˆ° AI æ ¸å¿ƒæ¨¡å‹åˆ†æçš„å…¨æµç¨‹éé˜»å¡æ ¡éªŒã€‚

### 2. ğŸš€ é«˜å¹¶å‘åº“å­˜æ‰£å‡æ–¹æ¡ˆ
é’ˆå¯¹ç”µå•†å¤§ä¿ƒåœºæ™¯ï¼Œè®¾è®¡äº†**Redis + Kafka + MySQL** çš„ä¸‰çº§åº“å­˜æ¶æ„ï¼Œå½»åº•è§£å†³è¶…å–é—®é¢˜ã€‚
- **Redis é¢„çƒ­ä¸åŸå­æ‰£å‡**ï¼šå•†å“ä¸Šæ¶è‡ªåŠ¨é¢„çƒ­åº“å­˜ï¼Œåˆ©ç”¨ Redis `DECRBY` å®ç°çº³ç§’çº§æ‰£å‡ï¼ŒæŠ—ä½é«˜å¹¶å‘æµé‡ã€‚
- **Kafka å‰Šå³°å¡«è°·**ï¼šæ‰£å‡æˆåŠŸåå‘é€ MQ æ¶ˆæ¯ï¼Œå¼‚æ­¥æ›´æ–°æ•°æ®åº“ï¼Œä¿æŠ¤æ ¸å¿ƒ DB ä¸è¢«å‡»ç©¿ã€‚
- **æœ€ç»ˆä¸€è‡´æ€§ä¸è¡¥å¿**ï¼šé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ä¿è¯ç¼“å­˜ä¸æ•°æ®åº“åº“å­˜çš„æœ€ç»ˆä¸€è‡´ï¼›å½“ MQ å‘é€å¤±è´¥æ—¶ï¼Œè‡ªåŠ¨å›æ»š Redis åº“å­˜ï¼ˆ`INCRBY`ï¼‰ï¼Œç¡®ä¿æ•°æ®å‡†ç¡®ã€‚

### 3. ğŸŒ è‡ªåŠ¨åŒ–å…¨çƒé“ºè´§ä¸ç²¾å‡†æ˜ å°„ (Mapping)
- **æ™ºèƒ½è¡¨å•æ ¡éªŒ**ï¼šä¼˜åŒ–äº†å•†å“æ˜ å°„äº¤äº’ï¼Œå®ç°äº†å¸ç§ä¸‹æ‹‰é€‰æ‹©ä¸å¤šç»´å¿…å¡«é¡¹ï¼ˆå¹³å°ã€å”®ä»·ã€å›½å®¶ç­‰ï¼‰çš„å‰ç«¯ä¸¥æ ¼æ ¡éªŒã€‚
- **AI å¤šè¯­è¨€ç¿»è¯‘**ï¼šé›†æˆ AI ç¿»è¯‘æœåŠ¡ï¼Œåœ¨æ¨é€å‰æ ¹æ®ç›®æ ‡å›½å®¶è‡ªåŠ¨å°†å•†å“ä¿¡æ¯ç¿»è¯‘ä¸ºå½“åœ°è¯­è¨€ã€‚ç¡®ä¿å­˜å…¥æ•°æ®åº“çš„å¤‡æ³¨å†…å®¹çº¯å‡€ã€ç›´æ¥å¯ç”¨ã€‚
- **çº§è”ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼šå®ç°äº† SKU ä¸ Mapping çš„å¼ºå…³è”ï¼ŒSKU é€»è¾‘åˆ é™¤æ—¶è‡ªåŠ¨çº§è”ä¸‹æ¶/åˆ é™¤å¯¹åº”å¹³å°çš„ Mappingã€‚

### 4. ğŸ’± å®æ—¶æ±‡ç‡ä¸åŠ¨æ€å®šä»·
- **å¤šå¸ç§æ”¯æŒ**ï¼šé›†æˆ ExchangeRate-API v6ï¼Œæ”¯æŒå¯åŠ¨è‡ªåŠ¨åˆ·æ–°ä¸å®šæ—¶åŒæ­¥ã€‚
- **å…œåº•ç­–ç•¥ (Fallback)**ï¼šè®¾è®¡äº†æœ¬åœ°å…œåº•æ±‡ç‡æœºåˆ¶ï¼Œå½“å¤–éƒ¨ API ä¸å¯ç”¨æˆ–ç½‘ç»œå¼‚å¸¸æ—¶ï¼Œè‡ªåŠ¨é™çº§ä½¿ç”¨é¢„è®¾æ±‡ç‡ï¼Œç¡®ä¿ä¸šåŠ¡ä¸ä¸­æ–­ã€‚
- **å‰ç«¯å®æ—¶è”åŠ¨**ï¼šSKU å®šä»·é¡µé¢æ”¯æŒåŸºäºæ±‡ç‡å’Œå€ç‡çš„å®æ—¶ä»·æ ¼è®¡ç®—ã€‚

## ğŸ“ æ¶æ„è®¾è®¡ (Architecture)

### ä¸šåŠ¡æµç¨‹ (Business Process)

1.  **å•†å“å‡†å…¥**ï¼šè¿è¥äººå‘˜åœ¨ç®¡ç†åå°æ–°å¢æˆ–ä¿®æ”¹ SPU/SKU ä¿¡æ¯ã€‚
2.  **è§¦å‘é£æ§**ï¼šç³»ç»Ÿæ ¹æ®é…ç½®ï¼ˆåŒæ­¥/å¼‚æ­¥ï¼‰è§¦å‘ AI æ ¡éªŒå¼•æ“ã€‚
3.  **AI é™çº§å·¡èˆª**ï¼š
    -   é¦–å…ˆè°ƒç”¨ **Gemini** è¿›è¡Œå›¾æ–‡ä¸€è‡´æ€§ä¸åˆè§„æ€§å®¡æŸ¥ã€‚
    -   è‹¥ Gemini é™æµæˆ–å¤±è´¥ï¼Œè‡ªåŠ¨åˆ‡è‡³ **OpenAI GPT-4o-mini** è§†è§‰ä¸“çº¿ã€‚
    -   è‹¥å®˜æ–¹æ¸ é“å‡ä¸å¯ç”¨ï¼Œè¿›å…¥ **OpenRouter** å…è´¹é›†ç¾¤è½®è¯¢ã€‚
    -   æœ€åç”± **DeepSeek** æä¾›å¸¦é‡è¯•æœºåˆ¶çš„ç»ˆæè‡ªæ„ˆè¯†åˆ«ã€‚
4.  **å®¡æ ¸å†³ç­–**ï¼š
    -   **PASS**ï¼šè‡ªåŠ¨ç”Ÿæˆå•†å“ Mapping è®°å½•ï¼Œè¿›å…¥æ¨é€é˜Ÿåˆ—ã€‚
    -   **BLOCK**ï¼šæ‹¦æˆªæ“ä½œï¼Œè®°å½•å¤±è´¥åŸå› å¹¶é€šçŸ¥è¿è¥äººå‘˜ã€‚
5.  **å¤šè¯­è¨€ç¿»è¯‘**ï¼šæ¨é€å‰è°ƒç”¨ AI ç¿»è¯‘ä¸“çº¿ï¼Œæ ¹æ®ç›®æ ‡å›½å®¶ï¼ˆå¦‚æ³°è¯­ã€æ—¥è¯­ï¼‰è‡ªåŠ¨è½¬æ¢è¯­ç§ã€‚
6.  **å…¨çƒåˆ†å‘**ï¼šæ ¹æ®ä¸åŒå¹³å°çš„æ¨é€ç­–ç•¥ï¼ˆAmazon/Shopeeï¼‰ï¼Œå°†çº¯å‡€çš„ç¿»è¯‘ç»“æœä¸å•†å“æ•°æ®åˆ†å‘è‡³æµ·å¤–å¸‚åœºã€‚

### ç›®å½•ç»“æ„ (Structure)

```text
com.john.cils
â”œâ”€â”€ common          // é€šç”¨æ¨¡å—
â”‚   â””â”€â”€ constant    // å¸¸é‡å®šä¹‰ (CilsConstants)
â”œâ”€â”€ controller      // æ§åˆ¶å±‚ (Restful API)
â”‚   â””â”€â”€ å„ä¸ªå‰ç«¯è®¿é—®æ¥å£
â”œâ”€â”€ domain          // é¢†åŸŸæ¨¡å‹
â”‚   â”œâ”€â”€ dto         // å·¥å…·å®ä½“
â”‚   â””â”€â”€ å„ä¸ªè¡¨çš„å®ä½“  // æ•°æ®åº“å®ä½“ (SPU, SKU, Mapping)
â”œâ”€â”€ mapper          // æ•°æ®è®¿é—®å±‚ (MyBatis Mapper XML)
â”œâ”€â”€ mq              // æ¶ˆæ¯é˜Ÿåˆ—æ¨¡å—
â”‚   â””â”€â”€ StockConsumer.java  // åº“å­˜æ‰£å‡æ¶ˆè´¹è€…
â”œâ”€â”€ service         // ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ impl        // ä¸šåŠ¡å®ç° (SkuServiceImpl åŒ…å«æ ¸å¿ƒ Diff é€»è¾‘)
â”‚   â”œâ”€â”€ push        // æ¨é€ç­–ç•¥ (Strategy Pattern å®ç°)
â”‚   â”œâ”€â”€ ... ä¸šåŠ¡å¤„ç†
â”‚   â””â”€â”€ ExchangeRateService.java // æ±‡ç‡æœåŠ¡ (å«å…œåº•ç­–ç•¥)
â”œâ”€â”€ task            // å®šæ—¶ä»»åŠ¡
â”‚   â””â”€â”€ ExchangeRateRefreshTask.java // æ¯æ—¥æ±‡ç‡åˆ·æ–°
â”œâ”€â”€ utils           // æ ¸å¿ƒå·¥å…·
â”‚   â”œâ”€â”€ platform    // æ¨¡æ‹Ÿå¹³å°æ¨é€è„šæœ¬
â”‚   â””â”€â”€ python      // Python è„šæœ¬è°ƒç”¨å·¥å…· (ProcessBuilder)
â””â”€â”€ verification    // AI æ ¡éªŒå¼•æ“æ ¸å¿ƒ
    â”œâ”€â”€ async       // å¼‚æ­¥è°ƒåº¦ (AsyncVerificationService)
    â”œâ”€â”€ engine      // è§„åˆ™æ‰§è¡Œå™¨ (VerificationEngine)
    â””â”€â”€ domain      // æ ¡éªŒç»“æœå¯¹è±¡

py_scripts          // AI æ ¸å¿ƒè„šæœ¬åº“ (Python)
â”œâ”€â”€ ai_client.py    // AI è°ƒåº¦ä¸­æ§ (å®ç° Gemini -> OpenAI -> DeepSeek é™çº§)
â”œâ”€â”€ openai_client.py // OpenAI 2025 Responses API å®˜æ–¹é€‚é…
â”œâ”€â”€ deepseek_client.py // DeepSeek ä¸“çº¿ä¸ 3æ¬¡/5s é‡è¯•é€»è¾‘
â”œâ”€â”€ openrouter_client.py // OpenRouter å…è´¹æ¨¡å‹é›†ç¾¤æ¥å…¥
â”œâ”€â”€ translator.py   // è‡ªåŠ¨åŒ–ç¿»è¯‘æµæ°´çº¿
â””â”€â”€ universal_checker.py // é€šç”¨å‡†å…¥åˆè§„æ€§æ ¡éªŒ
```

## ğŸš€ å¿«é€Ÿå¼€å§‹ (Getting Started)

1.  **ç¯å¢ƒå‡†å¤‡**ï¼š
    *   JDK 21, Maven 3.8+
    *   MySQL 8.0, Redis, Kafka, Zookeeper
    *   Python 3.x (éœ€å®‰è£… `google-generativeai`, `openai`, `requests` åº“)
2.  **é…ç½®**ï¼š
    *   åœ¨ `application.yml` ä¸­é…ç½®æ•°æ®åº“ã€Redisã€Kafka è¿æ¥ã€‚
    *   è®¾ç½®æ ¸å¿ƒç¯å¢ƒå˜é‡ï¼š
        *   `GEMINI_API_KEY`: Google Gemini ä¼šè¯ Key
        *   `OPENAI_API_KEY`: OpenAI å®˜æ–¹ Key
        *   `OPENROUTER_API_KEY`: OpenRouter è·¯ç”± Key
        *   `DEEPSEEK_API_KEY`: DeepSeek å®˜æ–¹ Key
        *   `EXCHANGERATE_API_KEY`: æ±‡ç‡ API Key (1500æ¬¡/æœˆå…è´¹ç‰ˆ)
3.  **å¯åŠ¨**ï¼š
    *   è¿è¡Œ `RuoYiApplication.java`ã€‚
    *   ç³»ç»Ÿå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åŒæ­¥æœ€æ–°æ±‡ç‡ï¼Œå¹¶ç”±åå°å®šæ—¶ä»»åŠ¡æ¯æ—¥åˆ·æ–°ã€‚

## ğŸ“ å¼€å‘è®¡åˆ’ (Roadmap)

- [âœ”] SPU/SKU æ ¸å¿ƒç®¡ç†
- [âœ”] AI æ™ºèƒ½é£æ§ä¸ç¿»è¯‘
- [âœ”] é«˜å¹¶å‘åº“å­˜æ‰£å‡

---
*Author: John | Tech Stack: Java 21, Spring Boot 2.5, Vue 3*


ä¸»è§†é¢‘  https://v.douyin.com/06oNzU6Ru6o/ w@S.yt 02/23 pqE:/
å®¹é”™æœºåˆ¶è¡¥å……  https://v.douyin.com/P0GekMsiITQ/ baN:/ g@b.nd 06/11